language: shell
before_install:
 - sudo add-apt-repository ppa:rmescandon/yq -y
 - sudo apt update
 - sudo apt install yq -y
script: ./ci/package.sh ${PUBLISH_DIR} ${TRAVIS_BRANCH}
env:
  global:
    - PUBLISH_DIR=publish
branches:
  - master
  - dev
before_deploy: cp ./build/* ${PUBLISH_DIR} && cp -R ./ci ${PUBLISH_DIR}
deploy:
  - provider: pages
    verbose: true
    skip_cleanup: true
    github_token: $GITHUB_TOKEN
    keep_history: false
    target_branch: publish
    local_dir: ${PUBLISH_DIR}
